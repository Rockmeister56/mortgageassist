<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MortgageAssist - AI-Powered Mortgage Support</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo"><a href="#"><span class="blue">MORTGAGE</span>ASSIST</a></div>
            <nav>
                <ul>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#how-it-works">How It Works</a></li>
                    <li><a href="#testimonials">Testimonials</a></li>
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="#" class="btn-primary" id="howMuchBtn">How Much?</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="key-icon">🔑</div>
                <h1>Mortgage Questions? Get Answers Instantly.</h1>
                <p>Skip the hold music. Our AI assistant helps with loan status, paperwork, and rate updates—day or night.</p>
                <a href="#chatbot" class="btn-primary">Ask Your Mortgage Question →</a>
            </div>
        </div>
    </section>

    <section id="chatbot" class="chatbot-section">
        <div class="container">
            <h2>Ask Our AI Assistant</h2>
            
            <div class="chatbot-wrapper">
                <!-- Left chat bubble example -->
                <div class="example-chat-left">
                    <div class="user-message">
                        <div class="message-bubble blue">
                            What's my loan's interest rate?
                        </div>
                    </div>
                    <div class="ai-message">
                        <div class="message-bubble white border-green">
                            Your rate is 6.25% (30-year fixed).
                        </div>
                    </div>
                </div>
                
                <!-- Chatbase embed iframe -->
                <div class="chatbot-container">
                    <iframe
                        src="https://www.chatbase.co/chatbot-iframe/JKHQAJDGl0bRE-7LSQkv4"
                        width="100%"
                        style="height: 520px;"
                        frameborder="0"
                    ></iframe>
                </div>
                
                <!-- Right chat bubble example -->
                <div class="example-chat-right">
                    <div class="user-message">
                        <div class="message-bubble blue">
                            What documents do I need to upload?
                        </div>
                    </div>
                    <div class="ai-message">
                        <div class="message-bubble white border-green">
                            You're missing your 2023 W-2. Upload here.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="features" class="benefits-section">
        <div class="container">
            <h2>Key Benefits</h2>
            <div class="benefits-grid">
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0066ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                            <polyline points="17 6 23 6 23 12"></polyline>
                        </svg>
                    </div>
                    <h3>Loan Status Updates</h3>
                    <p>Get real-time updates on your application progress</p>
                    <div class="quote">"Where's my application in underwriting?"</div>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0066ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <h3>Document Checklists</h3>
                    <p>Never miss important paperwork deadlines</p>
                    <div class="quote">"What's needed for closing?"</div>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0066ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="17 18 11 12 17 6"></polyline>
                            <polyline points="7 6 1 12 7 18"></polyline>
                        </svg>
                    </div>
                    <h3>Rate Comparisons</h3>
                    <p>Make informed decisions about rate locking</p>
                    <div class="quote">"Should I lock my rate today?"</div>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0066ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                            <line x1="8" y1="21" x2="16" y2="21"></line>
                            <line x1="12" y1="17" x2="12" y2="21"></line>
                        </svg>
                    </div>
                    <h3>Payment Calculators</h3>
                    <p>Instantly see how changes affect your payment</p>
                    <div class="quote">"What's my new monthly payment?"</div>
                </div>
            </div>
        </div>
    </section>

    <section id="how-it-works" class="how-it-works">
        <div class="container">
            <h2>How It Works</h2>
            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Ask</h3>
                    <p>Type your question (e.g., "Has my appraisal been scheduled?").</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Answer</h3>
                    <p>AI responds instantly with accurate details.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Act</h3>
                    <p>Upload files or book a call if needed.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="testimonials" class="testimonials">
        <div class="container">
            <h2>What Our Clients Say</h2>
            <div class="testimonial">
                <p class="quote">"Clients love the instant updates—our team saves 15+ hours/week!"</p>
                <p class="author">- [Loan Officer Name], [Company]</p>
            </div>
            <div class="stat">
                <div class="stat-number">40%</div>
                <div class="stat-description">fewer calls to our office since launch</div>
            </div>
        </div>
    </section>

    <section id="faq" class="faq-section">
        <div class="container">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h3>How do I lock my rate?</h3>
                    <p>You can lock your rate through our AI assistant or by contacting your loan officer directly. Rate locks typically last for 30, 45, or 60 days depending on your loan.</p>
                </div>
                <div class="faq-item">
                    <h3>What's the next step in my process?</h3>
                    <p>Our AI assistant can provide real-time updates on where you are in the mortgage process and what's needed next. Just ask "What's my next step?" or "What's my loan status?"</p>
                </div>
                <div class="faq-item">
                    <h3>Can I change my loan type?</h3>
                    <p>Yes, in many cases you can change your loan type during the application process. Ask our AI assistant about your options or schedule a call with your loan officer to discuss the benefits of different loan programs.</p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-info">
                <div class="footer-item">Secure & confidential</div>
                <div class="footer-item">NMLS-licensed expertise</div>
                <div class="footer-item">Bank-level encryption</div>
            </div>
        </div>
    </footer>

    <!-- Contact Form Modal - Using Netlify Forms -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <!-- Fine-Tunable Header with CSS Variables -->
<div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 20px; padding: 10px 0;">
    
    <!-- LEFT SIDE: Business Logo + Get a Quote -->
    <div style="flex: 1;">
        <!-- BUSINESS LOGO - Adjustable -->
        <img src="https://odetjszursuaxpapfwcy.supabase.co/storage/v1/object/public/form-assets/logos/logo_5f42f026-051a-42c7-833d-375fcac74252_1754796297597_logo3.png" 
             style="
                height: 150px;                    /* ADJUST: Logo size (try 60px, 80px, 90px) */
                margin-bottom: 20px;             /* ADJUST: Space below logo (try 8px, 15px, 20px) */
                margin-left: -5px;                /* ADJUST: Logo left position (try 5px, 10px, -5px) */
                display: block;
             ">
        
        <!-- GET A QUOTE TEXT - Adjustable -->
        <h2 style="
            margin: 0; 
            font-size: 24px;                    /* ADJUST: Text size (try 20px, 26px, 28px) */
            color: #333; 
            text-align: left;
            margin-left: 0px;                   /* ADJUST: Text left position (try 5px, 10px, -5px) */
            margin-top: 5px;                    /* ADJUST: Space above text (try 0px, 10px, 15px) */
        ">Get a Quote</h2>
    </div>
    
    <!-- RIGHT SIDE: Avatar - Adjustable -->
    <div style="
        flex: 0 0 auto; 
        text-align: center;
        margin-right: 10px;                     /* ADJUST: Avatar right position (try 0px, 15px, 20px) */
        margin-top: -5px;                       /* ADJUST: Avatar vertical position (try 0px, -10px, 5px) */
    ">
        <img src="https://odetjszursuaxpapfwcy.supabase.co/storage/v1/object/public/avatars/avatar_1754795551491_AI%20assist%20with%20button.png" 
             onclick="activateAIAssistant()" 
             style="
                width: 110px;                   /* ADJUST: Avatar size (try 100px, 120px, 130px) */
                cursor: pointer; 
                border-radius: 10px; 
                transition: transform 0.3s;
             "
             onmouseover="this.style.transform='scale(1.05)'"
             onmouseout="this.style.transform='scale(1.0)'">
        <p style="
            margin: 3px 0 0 0; 
            font-size: 11px;                    /* ADJUST: Caption size (try 10px, 12px, 13px) */
            color: #666;
        ">👋 Click to activate AI!</p>
    </div>
    
</div>
            <!-- Using Netlify Forms -->
            <form id="contactForm" name="contact" method="POST" data-netlify="true">
                <!-- Netlify form name -->
                <input type="hidden" name="form-name" value="contact">
                
                <div class="form-group">
                    <label for="name">Your Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="businessName">Business Name</label>
                    <input type="text" id="businessName" name="businessName" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="bestTime">Best Time to Contact</label>
                    <input type="text" id="bestTime" name="bestTime" required>
                </div>
                <div class="form-group">
                    <label for="preferredDate">Preferred Date to Contact</label>
                    <input type="date" id="preferredDate" name="preferredDate" required>
                </div>
                <button type="submit" class="btn-primary btn-full">Submit</button>
            </form>
        </div>
    </div>

    <!-- Hidden form for Netlify Forms detection -->
    <form name="contact" netlify netlify-honeypot="bot-field" hidden>
        <input type="text" name="name" />
        <input type="text" name="businessName" />
        <input type="tel" name="phone" />
        <input type="text" name="bestTime" />
        <input type="date" name="preferredDate" />
    </form>

    <script src="js/main.js"></script>
    <!-- Removed the chatbot.js script since we're using the Chatbase iframe -->
<script>
// Enhanced AI Avatar System with Voice Capabilities
const mortgageKnowledge = {
    greetings: [
        "Hi! I'm your AI mortgage assistant with expert knowledge from top mortgage guides.",
        "Hello! I'm here to guide you through the mortgage process step by step.",
        "Welcome! I can speak with you, fill your form, or answer any mortgage questions."
    ],
    
    voicePersonality: {
        rate: 0.85,
        pitch: 1.0,
        volume: 0.9,
        voicePreference: 'female' // or 'male'
    },
    
    formQuestions: [
        {field: 'name', question: "Let's start with your full name. What should I call you?", placeholder: "Your Name"},
        {field: 'business', question: "Great! Now, what's your business or company name?", placeholder: "Business Name"},
        {field: 'phone', question: "Perfect! What's the best phone number to reach you?", placeholder: "Phone Number"},
        {field: 'bestTime', question: "When's the best time to contact you?", placeholder: "Best Time to Contact"},
        {field: 'preferredDate', question: "And what date would you prefer for us to contact you?", placeholder: "Preferred Date"}
    ],
    
    expertResponses: {
        "mortgage basics": "A mortgage is a loan to buy your home. You pay it back monthly over 15-30 years. Your payment includes principal, interest, taxes, and insurance.",
        "loan types": "Main types are: Conventional (3% down, 620+ credit), FHA (3.5% down, 580+ credit), VA (0% down for veterans), and USDA (0% down, rural areas).",
        "qualification": "You need good credit, stable income, acceptable debt-to-income ratio, and down payment. I can help assess your situation!",
        "down payment": "Down payments range from 0-20%. FHA needs just 3.5%, conventional starts at 3%, VA and USDA can be 0%."
    }
};

// Voice System Setup
let speechSynthesis = window.speechSynthesis;
let recognition = null;
let currentFormStep = 0;
let isListening = false;
let userFormData = {};

// Initialize Speech Recognition
function initializeSpeechRecognition() {
    if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US';
        
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript.trim();
            console.log('User said:', transcript);
            handleVoiceInput(transcript);
        };
        
        recognition.onerror = function(event) {
            console.log('Speech recognition error:', event.error);
            speakToUser("I didn't catch that. Could you please repeat?");
            setTimeout(startListening, 1000);
        };
        
        recognition.onend = function() {
            isListening = false;
        };
    }
}

// Main Avatar Activation - 3 OPTIONS
function activateAIAssistant() {
    initializeSpeechRecognition();
    showAIOptionsMenu();
}

// Create 3-Option Menu
function showAIOptionsMenu() {
    // Remove existing interfaces
    closeAllAIInterfaces();
    
    const optionsHTML = `
        <div id="aiOptionsMenu" style="
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 90%; max-width: 450px; background: white; border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); z-index: 10000; padding: 30px;
            text-align: center;
        ">
            <div style="margin-bottom: 25px;">
                <div style="font-size: 40px; margin-bottom: 10px;">🤖</div>
                <h2 style="margin: 0; color: #333; font-size: 24px;">AI Mortgage Assistant</h2>
                <p style="color: #666; margin: 10px 0 0 0;">How would you like me to help you today?</p>
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button onclick="startVoiceAssistant()" style="
                    background: linear-gradient(135deg, #FF6B6B, #FF5252); color: white; border: none;
                    padding: 18px 25px; border-radius: 15px; font-size: 16px; cursor: pointer;
                    transition: all 0.3s; box-shadow: 0 4px 15px rgba(255,107,107,0.3);
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    🎤 Talk With Me (Voice Guided)
                </button>
                
                <button onclick="startGuidedForm()" style="
                    background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none;
                    padding: 18px 25px; border-radius: 15px; font-size: 16px; cursor: pointer;
                    transition: all 0.3s; box-shadow: 0 4px 15px rgba(76,175,80,0.3);
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    📝 Help Me Fill The Form
                </button>
                
                <button onclick="startChatQuestions()" style="
                    background: linear-gradient(135deg, #2196F3, #1976D2); color: white; border: none;
                    padding: 18px 25px; border-radius: 15px; font-size: 16px; cursor: pointer;
                    transition: all 0.3s; box-shadow: 0 4px 15px rgba(33,150,243,0.3);
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    💬 I Have Questions
                </button>
            </div>
            
            <button onclick="closeAllAIInterfaces()" style="
                position: absolute; top: 15px; right: 20px; background: none; border: none;
                color: #999; font-size: 24px; cursor: pointer;
            ">×</button>
        </div>
        
        <div id="aiBackdrop" onclick="closeAllAIInterfaces()" style="
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 9999;
        "></div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', optionsHTML);
}

// OPTION 1: Voice Assistant
function startVoiceAssistant() {
    closeAllAIInterfaces();
    createVoiceInterface();
    
    setTimeout(() => {
        speakToUser("Hi there! I'm your AI mortgage assistant. I'll help you complete your application by talking with you. Let's get started!");
        
        setTimeout(() => {
            currentFormStep = 0;
            userFormData = {};
            askNextFormQuestion();
        }, 3000);
    }, 500);
}

// Create Voice Interface
function createVoiceInterface() {
    const voiceHTML = `
        <div id="voiceInterface" style="
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 90%; max-width: 500px; background: white; border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); z-index: 10000; padding: 30px;
            text-align: center;
        ">
            <div style="margin-bottom: 20px;">
                <div id="voiceAvatar" style="font-size: 60px; margin-bottom: 15px;">🎤</div>
                <h3 style="margin: 0; color: #333;">Voice Assistant Active</h3>
            </div>
            
            <div id="voiceStatus" style="
                background: #f0f8ff; border: 2px solid #2196F3; border-radius: 15px;
                padding: 20px; margin: 20px 0; min-height: 60px; display: flex;
                align-items: center; justify-content: center;
            ">
                <p id="voiceMessage" style="margin: 0; font-size: 16px; color: #333;">Starting voice assistant...</p>
            </div>
            
            <div id="listeningIndicator" style="display: none; margin: 15px 0;">
                <div style="display: flex; justify-content: center; align-items: center; gap: 5px;">
                    <div class="pulse-dot" style="width: 8px; height: 8px; background: #FF5252; border-radius: 50%; animation: pulse 1.5s infinite;"></div>
                    <div class="pulse-dot" style="width: 8px; height: 8px; background: #FF5252; border-radius: 50%; animation: pulse 1.5s infinite 0.2s;"></div>
                    <div class="pulse-dot" style="width: 8px; height: 8px; background: #FF5252; border-radius: 50%; animation: pulse 1.5s infinite 0.4s;"></div>
                    <span style="margin-left: 10px; color: #FF5252; font-weight: bold;">Listening...</span>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button onclick="toggleListening()" id="listenButton" style="
                    background: #4CAF50; color: white; border: none; padding: 12px 20px;
                    border-radius: 10px; cursor: pointer; font-size: 14px;
                ">🎤 Start Listening</button>
                
                <button onclick="skipToFormFill()" style="
                    background: #FF9800; color: white; border: none; padding: 12px 20px;
                    border-radius: 10px; cursor: pointer; font-size: 14px;
                ">📝 Skip to Auto-Fill</button>
                
                <button onclick="closeAllAIInterfaces()" style="
                    background: #f44336; color: white; border: none; padding: 12px 20px;
                    border-radius: 10px; cursor: pointer; font-size: 14px;
                ">✕ Close</button>
            </div>
        </div>
        
        <style>
            @keyframes pulse {
                0%, 100% { transform: scale(1); opacity: 1; }
                50% { transform: scale(1.2); opacity: 0.7; }
            }
        </style>
        
        <div id="aiBackdrop" style="
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 9999;
        "></div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', voiceHTML);
}

// Voice Functions
function speakToUser(text, callback) {
    const msg = new SpeechSynthesisUtterance(text);
    
    // Get available voices
    const voices = speechSynthesis.getVoices();
    const femaleVoice = voices.find(voice => 
        voice.name.includes('Female') || 
        voice.name.includes('Samantha') || 
        voice.name.includes('Victoria') ||
        voice.name.includes('Karen')
    );
    
    if (femaleVoice) msg.voice = femaleVoice;
    msg.rate = mortgageKnowledge.voicePersonality.rate;
    msg.pitch = mortgageKnowledge.voicePersonality.pitch;
    msg.volume = mortgageKnowledge.voicePersonality.volume;
    
    // Update UI
    const voiceMessage = document.getElementById('voiceMessage');
    if (voiceMessage) {
        voiceMessage.textContent = text;
    }
    
    msg.onend = function() {
        if (callback) callback();
    };
    
    speechSynthesis.speak(msg);
}

// Ask Form Questions with Voice
function askNextFormQuestion() {
    if (currentFormStep >= mortgageKnowledge.formQuestions.length) {
        completedVoiceForm();
        return;
    }
    
    const question = mortgageKnowledge.formQuestions[currentFormStep];
    speakToUser(question.question, () => {
        setTimeout(startListening, 1000);
    });
}

// Handle Voice Input
function handleVoiceInput(transcript) {
    const question = mortgageKnowledge.formQuestions[currentFormStep];
    
    // Store the response
    userFormData[question.field] = transcript;
    
    // Fill the actual form field
    fillFormField(question.field, transcript);
    
    // Confirm and move to next question
    speakToUser(`Got it! ${transcript}. Let me get that entered for you.`, () => {
        currentFormStep++;
        setTimeout(askNextFormQuestion, 1500);
    });
}

// Fill Form Field
function fillFormField(fieldName, value) {
    let selector = '';
    switch(fieldName) {
        case 'name':
            selector = 'input[name="name"], input[placeholder*="Name"]:not([placeholder*="Business"])';
            break;
        case 'business':
            selector = 'input[name="business"], input[name="businessName"], input[placeholder*="Business"]';
            break;
        case 'phone':
            selector = 'input[name="phone"], input[type="tel"], input[placeholder*="Phone"]';
            break;
        case 'bestTime':
            selector = 'input[name="bestTime"], input[placeholder*="Time"]';
            break;
        case 'preferredDate':
            selector = 'input[type="date"], input[name="preferredDate"]';
            if (fieldName === 'preferredDate') {
                value = formatDateFromSpeech(value);
            }
            break;
    }
    
    const field = document.querySelector(selector);
    if (field) {
        field.focus();
        field.value = '';
        
        // Type with animation
        let i = 0;
        const typeTimer = setInterval(() => {
            field.value += value[i];
            i++;
            if (i >= value.length) {
                clearInterval(typeTimer);
                field.blur();
            }
        }, 50);
    }
}

// Format Date from Speech
function formatDateFromSpeech(spokenDate) {
    // Simple date formatting - you can enhance this
    const today = new Date();
    const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
    return nextWeek.toISOString().split('T')[0];
}

// Voice Form Completion
function completedVoiceForm() {
    speakToUser("Perfect! I've completed your mortgage application form. You can review it and submit when you're ready. Thank you for using our AI assistant!");
    
    setTimeout(() => {
        closeAllAIInterfaces();
    }, 4000);
}

// Listening Controls
function toggleListening() {
    if (isListening) {
        stopListening();
    } else {
        startListening();
    }
}

function startListening() {
    if (!recognition) {
        speakToUser("Sorry, voice recognition is not supported in your browser.");
        return;
    }
    
    isListening = true;
    const indicator = document.getElementById('listeningIndicator');
    const button = document.getElementById('listenButton');
    
    if (indicator) indicator.style.display = 'block';
    if (button) {
        button.textContent = '🔴 Stop Listening';
        button.style.background = '#f44336';
    }
    
    recognition.start();
}

function stopListening() {
    isListening = false;
    if (recognition) recognition.stop();
    
    const indicator = document.getElementById('listeningIndicator');
    const button = document.getElementById('listenButton');
    
    if (indicator) indicator.style.display = 'none';
    if (button) {
        button.textContent = '🎤 Start Listening';
        button.style.background = '#4CAF50';
    }
}

// OPTION 2: Guided Form (Your existing function)
function startGuidedForm() {
    closeAllAIInterfaces();
    simulateAIFormFilling(); // Your existing form demo
}

// OPTION 3: Chat Questions (Your existing chat system)
function startChatQuestions() {
    closeAllAIInterfaces();
    createAIChatInterface(); // Your existing chat
    
    setTimeout(() => {
        addAIMessage("Hi! I'm here to answer your mortgage questions. What would you like to know?");
        showQuickChatOptions();
    }, 500);
}

// Quick Chat Options
function showQuickChatOptions() {
    const options = `
        <div style="margin: 10px 0;">
            <button onclick="handleQuickQuestion('mortgage basics')" class="quick-option">🏠 Mortgage Basics</button>
            <button onclick="handleQuickQuestion('loan types')" class="quick-option">📋 Loan Types</button>
            <button onclick="handleQuickQuestion('qualification')" class="quick-option">💰 Qualification</button>
            <button onclick="handleQuickQuestion('down payment')" class="quick-option">💵 Down Payment</button>
        </div>
    `;
    document.getElementById('chatMessages').insertAdjacentHTML('beforeend', options);
}

// Chat Interface (Simplified version of your existing one)
function createAIChatInterface() {
    const chatHTML = `
        <div id="aiChatInterface" style="
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 90%; max-width: 500px; height: 600px; background: white; 
            border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 10000; display: flex; flex-direction: column;
        ">
            <div style="background: linear-gradient(135deg, #2196F3, #1976D2); color: white; 
                        padding: 15px; border-radius: 15px 15px 0 0; text-align: center;">
                <h3 style="margin: 0;">💬 Mortgage Q&A</h3>
                <button onclick="closeAllAIInterfaces()" style="position: absolute; top: 10px; right: 15px; 
                        background: none; border: none; color: white; font-size: 20px; cursor: pointer;">×</button>
            </div>
            
            <div id="chatMessages" style="flex: 1; padding: 15px; overflow-y: auto; background: #f8f9fa;"></div>
            
            <div style="padding: 15px; border-top: 1px solid #eee;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="userInput" placeholder="Ask about mortgages..." 
                           style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px;"
                           onkeypress="if(event.key==='Enter') sendChatMessage()">
                    <button onclick="sendChatMessage()" style="background: #2196F3; color: white; border: none; 
                            border-radius: 50%; width: 40px; height: 40px; cursor: pointer;">→</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', chatHTML);
}

// Chat Functions
function sendChatMessage() {
    const input = document.getElementById('userInput');
    const message = input.value.trim();
    if (!message) return;
    
    addChatMessage(message, 'user');
    input.value = '';
    
    setTimeout(() => {
        const response = getChatResponse(message);
        addChatMessage(response, 'ai');
    }, 800);
}

function addChatMessage(message, sender) {
    const chatMessages = document.getElementById('chatMessages');
    const isAI = sender === 'ai';
    
    chatMessages.insertAdjacentHTML('beforeend', `
        <div style="margin-bottom: 15px; text-align: ${isAI ? 'left' : 'right'};">
            <div style="display: inline-block; max-width: 80%; padding: 10px 15px; border-radius: 15px;
                        background: ${isAI ? '#e3f2fd' : '#2196f3'}; color: ${isAI ? '#333' : 'white'};">
                ${isAI ? '🤖 ' : ''}${message}
            </div>
        </div>
    `);
    
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

function getChatResponse(message) {
    const msg = message.toLowerCase();
    for (const [key, value] of Object.entries(mortgageKnowledge.expertResponses)) {
        if (msg.includes(key) || msg.includes(key.replace(' ', ''))) {
            return value;
        }
    }
    return "Great question! I can help with mortgage basics, loan types, qualification requirements, and down payments. What specifically would you like to know?";
}

function handleQuickQuestion(topic) {
    addChatMessage(topic.charAt(0).toUpperCase() + topic.slice(1) + "?", 'user');
    setTimeout(() => {
        addChatMessage(mortgageKnowledge.expertResponses[topic], 'ai');
    }, 500);
}

// Skip to Auto-Fill Demo
function skipToFormFill() {
    closeAllAIInterfaces();
    simulateAIFormFilling(); // Your existing form demo
}

// Utility Functions
function closeAllAIInterfaces() {
    const interfaces = ['aiOptionsMenu', 'voiceInterface', 'aiChatInterface', 'aiBackdrop'];
    interfaces.forEach(id => {
        const element = document.getElementById(id);
        if (element) element.remove();
    });
    
    if (recognition && isListening) {
        recognition.stop();
    }
    speechSynthesis.cancel();
    isListening = false;
}

// Quick option styling
const quickOptionStyles = `
    <style>
        .quick-option {
            background: #e3f2fd; border: 1px solid #2196f3; border-radius: 15px;
            padding: 8px 12px; margin: 3px; font-size: 12px; cursor: pointer;
            color: #1976d2; transition: all 0.3s;
        }
        .quick-option:hover {
            background: #2196f3; color: white;
        }
    </style>
`;
document.head.insertAdjacentHTML('beforeend', quickOptionStyles);

// Initialize voices when available
speechSynthesis.onvoiceschanged = function() {
    console.log('Voices loaded:', speechSynthesis.getVoices().length);
};
</script>

</body>
</html>

Hey guys! Looking good Richard ... you made it! 
https://solutionsproviders.wixsite.com/femalevoxfuryYay hoo! https://solutionsproviders.wixsite.com/risingfury
